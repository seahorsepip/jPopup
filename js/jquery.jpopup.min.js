function jPopup(t){function o(){x=$("html").scrollTop(),"fixed"!=$("html").css("position")&&t.overlay&&$("html").css({width:"100%",height:"100%",position:"fixed",top:-x})}function s(){"fixed"!=$("html").css("position")||$("[data-popup][data-overlay]").length||($("html").css("position","static"),$("html").scrollTop(-parseInt($("html").css("top"))),$("html").css({width:"",height:"",top:0}))}function e(){$("body").append(X).append(H),p(),n(),a(),l(),r(),v(),h(),f(),H.attr("data-position",t.position).fadeTo(t.speed,1),y=!0}function i(){_.off("mousedown touchstart"),z.off("scroll"),H.off("click mousedown touchstart mmouseup touchend"),$(window).off("resize",Y),$(document).off("mousemove touchmove",L),H.fadeOut(t.speed,function(){H.remove(),s()}),X.fadeOut(t.speed,function(){X.remove()}),y=!1}function n(){t.overlay?(H.attr("data-overlay",""),X.css("z-index",H.css("z-index")).show(),o()):(H.removeAttr("data-overlay"),X.hide(),s())}function l(){t.draggable?(_.css("cursor","move"),"bottom"!=t.position&&"bottomLeft"!=t.position&&"bottomRight"!=t.position&&"stretchBottom"!=t.position||!t.stickToBottom||(stickToBottom=!1,r())):_.css("cursor","inherit")}function a(){t.closeButton?E.show():E.hide()}function r(){switch(t.position){case"center":H.css({width:0,height:0,position:"fixed",top:"50%",left:"50%",bottom:"",right:""}),R.css({width:"",height:"",position:"relative",top:-R.outerHeight()/2,left:-R.outerWidth()/2,bottom:""})
break
case"top":H.css({width:0,height:0,position:"fixed",top:0,left:"50%",bottom:"",right:""}),R.css({width:"",height:"",position:"relative",top:0,left:-R.outerWidth()/2,bottom:""})
break
case"left":H.css({width:0,height:0,position:"fixed",top:"50%",left:0,bottom:"",right:""}),R.css({width:"",height:"",position:"relative",top:-R.outerHeight()/2,left:0,bottom:""})
break
case"bottom":H.css({width:0,height:0,position:"fixed",top:"",left:"50%",bottom:0,right:""}),"bottom"!=t.position&&"bottomLeft"!=t.position&&"bottomRight"!=t.position&&"stretchBottom"!=t.position||t.draggable?R.css({width:"",height:"",position:"relative",top:-R.outerHeight(),left:-R.outerWidth()/2,bottom:""}):R.css({position:"absolute",top:"",left:-R.outerWidth()/2,bottom:0})
break
case"right":H.css({width:0,height:0,position:"fixed",top:"50%",left:"",bottom:0,right:0}),R.css({width:"",height:"",position:"relative",top:-R.outerHeight()/2,left:-R.outerWidth(),bottom:""})
break
case"topLeft":H.css({width:0,height:0,position:"fixed",top:0,left:0,bottom:"",right:""}),R.css({width:"",height:"",position:"relative",top:0,left:0,bottom:""})
break
case"topRight":H.css({width:0,height:0,position:"fixed",top:0,left:"",bottom:"",right:0}),R.css({width:"",height:"",position:"relative",top:0,left:-R.outerWidth(),bottom:""})
break
case"bottomLeft":H.css({width:0,height:0,position:"fixed",top:"",left:"0",bottom:0,right:""}),"bottom"!=t.position&&"bottomLeft"!=t.position&&"bottomRight"!=t.position&&"stretchBottom"!=t.position||t.draggable?R.css({width:"",height:"",position:"relative",top:-R.outerHeight(),left:0,bottom:""}):R.css({position:"absolute",top:"",left:0,bottom:0})
break
case"bottomRight":H.css({width:0,height:0,position:"fixed",top:"",left:"",bottom:0,right:0}),"bottom"!=t.position&&"bottomLeft"!=t.position&&"bottomRight"!=t.position&&"stretchBottom"!=t.position||t.draggable?R.css({width:"",height:"",position:"relative",top:-R.outerHeight(),left:-R.outerWidth(),bottom:""}):R.css({position:"absolute",top:"",left:-R.outerWidth(),bottom:0})
break
case"stretchTop":H.css({width:"100%",height:0,position:"fixed",top:0,left:0,bottom:"",right:""}),R.css({width:"100%",height:"",position:"relative",top:0,left:0,bottom:""})
break
case"stretchLeft":H.css({width:0,height:"100%",position:"fixed",top:0,left:0,bottom:"",right:""}),R.css({width:"",height:"100%",position:"relative",top:0,left:0,bottom:""})
break
case"stretchBottom":H.css({width:"100%",height:0,position:"fixed",top:"",left:0,bottom:0,right:""}),"bottom"!=t.position&&"bottomLeft"!=t.position&&"bottomRight"!=t.position&&"stretchBottom"!=t.position||t.draggable?R.css({width:"100%",height:"",position:"relative",top:-R.outerHeight(),left:0,bottom:""}):R.css({width:"100%",height:"",position:"absolute",top:"",left:0,bottom:0})
break
case"stretchRight":H.css({width:0,height:"100%",position:"fixed",top:0,left:"",bottom:"",right:0}),R.css({width:"",height:"100%",position:"relative",top:0,left:-R.outerWidth(),bottom:""})}}function c(){$(window).height()-R.offset().top-R.outerHeight()+$("html").scrollTop()<0&&R.offset({top:$(window).height()-R.outerHeight()+$("html").scrollTop()}),$(window).width()-R.offset().left-R.outerWidth()<0&&R.offset({left:$(window).width()-R.outerWidth()}),R.offset().top-$("html").scrollTop()<0&&(t.draggable||"bottom"!=t.position)&&R.offset({top:$("html").scrollTop()}),R.offset().left<0&&R.offset({left:0})}function h(){H.removeClass(t.overflowXClass+" "+t.overflowYClass)
var o=R.outerWidth()>$(window).width()?!0:!1,s=R.outerHeight()>$(window).height()?!0:!1
o&&H.addClass(t.overflowXClass),s&&H.addClass(t.overflowYClass)}function f(){z.scrollTop()?H.removeClass(t.scrollTopClass):H.addClass(t.scrollTopClass),z.prop("scrollHeight")-z.height()-z.scrollTop()?H.removeClass(t.scrollBottomClass):H.addClass(t.scrollBottomClass)}function p(){H.css("z-index",d()+1)}function u(){var t=H.css("z-index"),o=d()
$("[data-popup]").each(function(){var o=parseInt($(this).css("z-index"))
o>t&&$(this).css("z-index",o-1)}),H.css("z-index",o)}function d(){var t=[9999]
return $("[data-popup]").each(function(){var o=parseInt($(this).css("z-index"))
o&&t.push(o)}),Math.max.apply(Math,t)}function v(o,s){s=void 0==s?t.offset.y:s,o=void 0==o?t.offset.x:o,fY=R.offset().top,B=R.offset().left,R.offset({top:fY-s,left:B+o}),c()}function m(){var o={}
switch(t.position){case"center":case"left":case"right":o.y=H.offset().top-R.offset().top-R.outerHeight()/2
break
case"top":case"topLeft":case"topRight":case"stretchTop":case"stretchLeft":case"stretchRight":o.y=H.offset().top-R.offset().top
break
case"bottom":case"bottomLeft":case"bottomRight":case"stretchBottom":o.y=H.offset().top-R.offset().top-R.outerHeight()}switch(t.position){case"center":case"top":case"bottom":o.x=R.offset().left-H.offset().left+R.outerWidth()/2
break
case"left":case"topLeft":case"bottomLeft":case"stretchTop":case"stretchLeft":case"stretchBottom":o.x=R.offset().left-H.offset().left
break
case"right":case"topRight":case"bottomRight":case"stretchRight":o.x=R.offset().left-H.offset().left+R.outerWidth()}return o.y=Math.round(o.y),o.x=Math.floor(o.x),o}function g(){for(var o="",s=0;s<t.buttons.length;s++){var e=t.buttons[s]["class"]?" class="+t.buttons[s]["class"]:"",i=t.buttons[s].checkForm?" data-checkform=true":"",n=t.buttons[s].close===!1?" data-close="+t.buttons[s].close:"",l=void 0!==t.buttons[s].value?" data-value="+t.buttons[s].value:"",a=t.buttons[s].text||""
o+="<button"+e+n+i+l+">"+a+"</button>"}return o}function C(){return"function"==typeof document.createElement("input").checkValidity}var b="popup",w={title:"",content:"",buttons:[],popupClass:b,wrapperClass:b+"_wrapper",overlayClass:b+"_overlay",titleClass:b+"_title",contentClass:b+"_content",buttonsClass:b+"_buttons",overflowXClass:b+"_overflow_x",overflowYClass:b+"_overflow_y",scrollTopClass:b+"_scroll_top",scrollBottomClass:b+"_scroll_bottom",closeButtonClass:b+"_close",closeButtonContent:'&times;<svg fill="#000000" width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>',closeButton:!1,overlay:!0,overlayClose:!1,draggable:!1,position:"center",offset:{x:0,y:0},speed:200,stickToBottom:!0,keyClose:!1}
t=$.extend(w,t)
var y,x,B,B,k,T,Y,L,W=$('<div><div class="'+t.overlayClass+'" style="position: fixed; top: 0; left: 0; bottom: 0; right: 0;"></div><div class="'+t.wrapperClass+'" style="opacity: 0;" data-popup><form class="'+t.popupClass+'" style="position: relative; float: left;"><div class="'+t.titleClass+'">'+t.title+'</div><div class="'+t.contentClass+'">'+t.content+'</div><div class="'+t.buttonsClass+'">'+g()+'</div><div class="'+t.closeButtonClass+'">'+t.closeButtonContent+"</div></form></div></div>"),H=W.children("div:last-child"),R=H.children("form"),X=W.children("div:first-child"),_=R.children("."+t.titleClass),z=R.children("."+t.contentClass),M=R.children("."+t.buttonsClass),E=R.children("."+t.closeButtonClass),D=!1
this.open=function(o){var s=$.Deferred()
e()
var n=!1
return M.on("click","button",function(t){t.preventDefault()
var o=$(this).data("value"),e=$(this).data("checkform"),l=$(this).data("close")
C()&&e?(console.log(R[0].checkValidity()),R[0].checkValidity()?(n||s.notify(o,R),0!=l&&(i(),n=!0)):$('<input type="submit">').hide().appendTo(R).click().remove()):(n||s.notify(o,R),0!=l&&(i(),n=!0))}),E.on("click",function(t){t.preventDefault(),i()}),z.on("scroll",function(){f()}),Y=function(){c(),h(),f()},$(window).on("resize",Y),_.on("mousedown touchstart",function(o){t.draggable&&(D=!0,fY=R.offset().top,B=R.offset().left,k=o.pageY||o.originalEvent.touches[0].pageY,T=o.pageX||o.originalEvent.touches[0].pageX,R.css("user-select","none"))}),L=function(o){D&&t.draggable&&(mY=void 0==o.pageY?o.originalEvent.touches[0].pageY:o.pageY,mX=void 0==o.pageX?o.originalEvent.touches[0].pageX:o.pageX,R.offset({top:fY+mY-k,left:B+mX-T}),c())},$(document).on("mousemove touchmove",L),H.on("mouseup touchend",function(o){t.draggable&&(D=!1,R.css("user-select","inherit"))}),H.on("mousedown touchstart",function(){t.draggable&&u()}),X.on("click",function(){t.overlayClose&&i()}),$(document).on("keydown",function(o){o.which==t.keyClose&&H.css("z-index")==d()&&y&&i()}),s.progress(o)},this.close=function(){return i(),this},this.addClass=function(t){return H.addClass(t),this},this.removeClass=function(t){return H.removeClass(t),this},this.title=function(o){return void 0==o?t.title:(_.html(o),t.title=o,this)},this.content=function(o){return void 0==o?t.content:(z.html(o),t.content=o,this)},this.buttons=function(o){return void 0==o?t.buttons:(t.buttons=o,M.html(g()),this)},this.overlay=function(o){return void 0==o?t.overlay:(t.overlay=o?!0:!1,n(),this)},this.draggable=function(o){return void 0==o?t.draggable:(t.draggable=o?!0:!1,l(),this)},this.closeButton=function(o){return void 0==o?t.closeButton:(t.closebutton=o?!0:!1,a(),this)},this.popupClass=function(o){return void 0==o?t.popupClass:(R.removeClass(t.popupClass).addClass(o),t.popupClass=o,this)},this.wrapperClass=function(o){return void 0==o?t.wrapperClass:(H.removeClass(t.wrapperClass).addClass(o),t.wrapperClass=o,this)},this.overlayClass=function(o){return void 0==o?t.overlayClass:(X.removeClass(t.overlayClass).addClass(o),t.overlayClass=o,this)},this.titleClass=function(o){return void 0==o?t.titleClass:(_.removeClass(t.titleClass).addClass(o),t.titleClass=o,this)},this.contentClass=function(o){return void 0==o?t.contentClass:(z.removeClass(t.contentClass).addClass(o),t.contentClass=o,this)},this.buttonsClass=function(o){return void 0==o?t.buttonsClass:(M.removeClass(t.buttonsClass).addClass(o),t.buttonsClass=o,this)},this.overflowXClass=function(o){return void 0==o?t.overflowXClass:(H.removeClass(t.overflowXClass).addClass(o),t.overflowXClass=o,this)},this.overflowYClass=function(o){return void 0==o?t.overflowYClass:(H.removeClass(t.overflowYClass).addClass(o),t.overflowYClass=o,this)},this.scrollTopClass=function(o){return void 0==o?t.scrollTopClass:(H.removeClass(t.scrollTopClass).addClass(o),t.scrollTopClass=o,this)},this.scrollBottomClass=function(o){return void 0==o?t.scrollBottomClass:(H.removeClass(t.scrollBottomClass).addClass(o),t.scrollBottomClass=o,this)},this.closeButtonClass=function(o){return void 0==o?t.closeButtonClass:(E.removeClass(t.closeButtonClass).addClass(o),t.closeButtonClass=o,this)},this.closeButtonContent=function(o){return void 0==fCloseButtonHTML?t.closeButtonContent:(E.html(o),t.closeButtonContent=o,this)},this.speed=function(o){return void 0==fSpeed?t.speed:(t.speed=fSpeed,this)},this.position=function(o){return void 0==o?t.position:(H.removeAttr("data-position").attr("data-position",o),t.position=o,t.offset.y=0,t.offset.x=0,r(),r(),this)},this.offset=function(t){if(void 0==t)return m()
var o=void 0==t.y?0:t.y,s=void 0==t.x?0:t.x
return v(s,o),this},this.overlayClose=function(o){return void 0==o?t.overlayClose:(t.overlayClose=o?!0:!1,this)},this.stickToBottom=function(o){return void 0==o?t.stickToBottom:(t.stickToBottom=o?!0:!1,t.offset.y=0,t.offset.x=0,r(),r(),void 0)},this.keyClose=function(o){return void 0==o?t.keyClose:void(t.keyClose=o?o:!1)},this.popupWrapper=function(){return H},this.popupOverlay=function(){return X},this.popup=function(){return R},this.popupTitle=function(){return _},this.popupContent=function(){return z},this.popupButtons=function(){return M},this.popupClose=function(){return E}}
