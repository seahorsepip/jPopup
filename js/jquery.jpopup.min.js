function jPopup(a){function k(){"fixed"!=$("html").css("position")||$("[data-popup][data-overlay]").length||($("html").css("position","static"),$("html").scrollTop(-parseInt($("html").css("top"))),$("html").css("top",0))}function l(){g.off("mousedown touchstart");e.off("scroll");d.off("click mousedown touchstart mmouseup touchend");d.fadeOut(a.speed,function(){d.remove();k()});f.fadeOut(a.speed,function(){f.remove()});m=!1}function x(){a.overlay?(d.attr("data-overlay",""),f.css("z-index",d.css("z-index")).show(),
y=$("html").scrollTop(),"fixed"!=$("html").css("position")&&a.overlay&&$("html").css({position:"fixed",top:-y})):(d.removeAttr("data-overlay"),f.hide(),k())}function z(){a.draggable?(g.css("cursor","move"),"bottom"==a.position&&a.stickToBottom&&(stickToBottom=!1,h())):g.css("cursor","inherit")}function A(){a.closeButton?n.show():n.hide()}function h(){switch(a.position){case "center":d.css({position:"fixed",top:"50%",left:"50%",bottom:"auto",right:"auto"});c.css({position:"relative",top:-c.outerHeight()/
2,left:-c.outerWidth()/2,bottom:"auto"});break;case "top":d.css({position:"fixed",top:0,left:"50%",bottom:"auto",right:"auto"});c.css({position:"relative",top:0,left:-c.outerWidth()/2,bottom:"auto"});break;case "left":d.css({position:"fixed",top:"50%",left:"0",bottom:"auto",right:"auto"});c.css({position:"relative",top:-c.outerHeight()/2,left:0,bottom:"auto"});break;case "bottom":d.css({position:"fixed",top:"auto",left:"50%",bottom:0,right:"auto"});a.stickToBottom&&!a.draggable?c.css({position:"absolute",
top:"auto",left:-c.outerWidth()/2,bottom:0}):c.css({position:"relative",top:-c.outerHeight(),left:-c.outerWidth()/2,bottom:"auto"});break;case "right":d.css({position:"fixed",top:"50%",left:"auto",bottom:0,right:0}),c.css({position:"relative",top:-c.outerHeight()/2,left:-c.outerWidth(),bottom:"auto"})}}function r(){0>$(window).height()-c.offset().top-c.outerHeight()+$("html").scrollTop()&&c.offset({top:$(window).height()-c.outerHeight()+$("html").scrollTop()});0>$(window).width()-c.offset().left-
c.outerWidth()&&c.offset({left:$(window).width()-c.outerWidth()});0>c.offset().top-$("html").scrollTop()&&(a.draggable||"bottom"!=a.position)&&c.offset({top:$("html").scrollTop()});0>c.offset().left&&c.offset({left:0})}function B(){d.removeClass(a.overflowXClass+" "+a.overflowYClass);var b=c.outerWidth()>$(window).width()?!0:!1,p=c.outerHeight()>$(window).height()?!0:!1;b&&d.addClass(a.overflowXClass);p&&d.addClass(a.overflowYClass)}function t(){e.scrollTop()?d.removeClass(a.scrollTopClass):d.addClass(a.scrollTopClass);
e.prop("scrollHeight")-e.height()-e.scrollTop()?d.removeClass(a.scrollBottomClass):d.addClass(a.scrollBottomClass)}function H(){var a=d.css("z-index"),c=u();$("[data-popup]").each(function(){var c=parseInt($(this).css("z-index"));c>a&&$(this).css("z-index",c-1)});d.css("z-index",c)}function u(){var a=[9999];$("[data-popup]").each(function(){var c=parseInt($(this).css("z-index"));c&&a.push(c)});return Math.max.apply(Math,a)}function C(b,d){d=void 0==d?a.offset.y:d;b=void 0==b?a.offset.x:b;fY=c.offset().top;
q=c.offset().left;c.offset({top:fY-d,left:q+b});r()}function D(){for(var b="",c=0;c<a.buttons.length;c++)b+="<button"+(a.buttons[c]["class"]?" class="+a.buttons[c]["class"]:"")+(!1===a.buttons[c].close?" data-close="+a.buttons[c].close:"")+(a.buttons[c].checkForm?" data-checkform=true":"")+(void 0!==a.buttons[c].value?" data-value="+a.buttons[c].value:"")+">"+(a.buttons[c].text||"")+"</button>";return b}a=$.extend({title:"",content:"",buttons:[],"class":"popup",wrapperClass:"popup_wrapper",overlayClass:"popup_overlay",
titleClass:"popup_title",contentClass:"popup_content",buttonsClass:"popup_buttons",overflowXClass:"popup_overflow_x",overflowYClass:"popup_overflow_y",scrollTopClass:"popup_scroll_top",scrollBottomClass:"popup_scroll_bottom",closeButtonClass:"popup_close",closeButtonContent:'<svg fill="#000000" width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>',closeButton:!1,
overlay:!0,overlayClose:!1,draggable:!1,position:"center",offset:{x:0,y:0},speed:200,stickToBottom:!0,keyClose:!1},a);var E=$('<div><div class="'+a.overlayClass+'" style="position: fixed; top: 0; left: 0; bottom: 0; right: 0;"></div><div class="'+a.wrapperClass+'" style="opacity: 0; width: 0; height: 0;" data-popup><form class="'+a["class"]+'" style="position: relative;"><div class="'+a.titleClass+'">'+a.title+'</div><div class="'+a.contentClass+'">'+a.content+'</div><div class="'+a.buttonsClass+
'">'+D()+'</div><div class="'+a.closeButtonClass+'">'+a.closeButtonContent+"</div></form></div></div>"),d=E.children("div:last-child"),c=d.children("form"),f=E.children("div:first-child"),g=c.children("."+a.titleClass),e=c.children("."+a.contentClass),v=c.children("."+a.buttonsClass),n=c.children("."+a.closeButtonClass),m,y,q,F,G,w=!1;this.open=function(b){var p=$.Deferred();$("body").append(f).append(d);d.css("z-index",u()+1);x();A();z();h();C();B();t();d.fadeTo(a.speed,1);m=!0;var k=!1;v.on("click",
"button",function(a){a.preventDefault();a=$(this).data("value");var b=$(this).data("checkform"),d=$(this).data("close");!c[0].checkValidity()&&b?$('<input type="submit">').hide().appendTo(c).click().remove():(k||p.notify(a,c),!1!==d&&(l(),k=!0))});n.on("click",function(a){a.preventDefault();l()});e.on("scroll",function(){t()});$(window).on("resize",function(){m&&(r(),B(),t())});g.on("mousedown touchstart",function(b){a.draggable&&(w=!0,fY=c.offset().top,q=c.offset().left,F=b.pageY||b.originalEvent.touches[0].pageY,
G=b.pageX||b.originalEvent.touches[0].pageX,c.css("user-select","none"))});$(window).on("mousemove touchmove",function(b){w&&a.draggable&&m&&(mY=void 0==b.pageY?b.originalEvent.touches[0].pageY:b.pageY,mX=void 0==b.pageX?b.originalEvent.touches[0].pageX:b.pageX,c.offset({top:fY+mY-F,left:q+mX-G}),r())});d.on("mouseup touchend",function(b){a.draggable&&(w=!1,c.css("user-select","inherit"))});d.on("mousedown touchstart",function(){a.draggable&&H()});f.on("click",function(){a.overlayClose&&l()});$(document).on("keydown",
function(b){b.which==a.keyClose&&d.css("z-index")==u()&&m&&l()});return p.progress(b)};this.close=function(){l();return this};this.addClass=function(a){d.addClass(a);return this};this.removeClass=function(a){d.removeClass(a);return this};this.title=function(b){if(void 0==b)return a.title;g.html(a.fTitle);a.title=b;return this};this.content=function(b){if(void 0==b)return a.content;e.html(a.fContent);a.content=b;return this};this.buttons=function(b){if(void 0==b)return a.buttons;a.buttons=b;v.html(D());
return this};this.overlay=function(b){if(void 0==b)return a.overlay;a.overlay=b?!0:!1;x();return this};this.draggable=function(b){if(void 0==b)return a.draggable;a.draggable=b?!0:!1;z();return this};this.closeButton=function(b){if(void 0==b)return a.closeButton;a.closebutton=b?!0:!1;A();return this};this["class"]=function(b){if(void 0==b)return a["class"];c.removeClass(a["class"]).addClass(b);a["class"]=b;return this};this.wrapperClass=function(b){if(void 0==b)return a.wrapperClass;d.removeClass(a.wrapperClass).addClass(b);
a.wrapperClass=b;return this};this.overlayClass=function(b){if(void 0==b)return a.overlayClass;f.removeClass(a.overlayClass).addClass(b);a.overlayClass=b;return this};this.titleClass=function(b){if(void 0==b)return a.titleClass;g.removeClass(a.titleClass).addClass(b);a.titleClass=b;return this};this.contentClass=function(b){if(void 0==b)return a.contentClass;e.removeClass(a.contentClass).addClass(b);a.contentClass=b;return this};this.buttonsClass=function(b){if(void 0==b)return a.buttonsClass;v.removeClass(a.buttonsClass).addClass(b);
a.buttonsClass=b;return this};this.overflowXClass=function(b){if(void 0==b)return a.overflowXClass;d.removeClass(a.overflowXClass).addClass(b);a.overflowXClass=b;return this};this.overflowYClass=function(b){if(void 0==b)return a.overflowYClass;d.removeClass(a.overflowYClass).addClass(b);a.overflowYClass=b;return this};this.scrollTopClass=function(b){if(void 0==b)return a.scrollTopClass;d.removeClass(a.scrollTopClass).addClass(b);a.scrollTopClass=b;return this};this.scrollBottomClass=function(b){if(void 0==
b)return a.scrollBottomClass;d.removeClass(a.scrollBottomClass).addClass(b);a.scrollBottomClass=b;return this};this.closeButtonClass=function(b){if(void 0==b)return a.closeButtonClass;n.removeClass(a.closeButtonClass).addClass(b);a.closeButtonClass=b;return this};this.closeButtonContent=function(b){if(void 0==fCloseButtonHTML)return a.closeButtonContent;n.html(fCloseButtonHTML);a.closeButtonContent=b;return this};this.speed=function(b){if(void 0==fSpeed)return a.speed;a.speed=fSpeed;return this};
this.position=function(b){if(void 0==b)return a.position;a.position=b;h();a.offset.y=0;a.offset.x=0;return this};this.offset=function(b){if(void 0==b){b={};switch(a.position){case "center":case "left":case "right":b.y=d.offset().top-c.offset().top-c.outerHeight()/2;break;case "top":b.y=d.offset().top-c.offset().top;break;case "bottom":b.y=d.offset().top-c.offset().top-c.outerHeight()}switch(a.position){case "center":case "top":case "bottom":b.x=c.offset().left-d.offset().left+c.outerWidth()/2;break;
case "left":b.x=c.offset().left-d.offset().left;break;case "right":b.x=c.offset().left-d.offset().left+c.outerWidth()}b.y=Math.round(b.y);b.x=Math.floor(b.x);return b}C(void 0==b.x?0:b.x,void 0==b.y?0:b.y);return this};this.overlayClose=function(b){if(void 0==b)return a.overlayClose;a.overlayClose=b?!0:!1;h();return this};this.stickToBottom=function(b){if(void 0==b)return a.stickToBottom;a.stickToBottom=b?!0:!1;a.offset.y=0;a.offset.x=0;h();h()};this.keyClose=function(b){if(void 0==b)return a.keyClose;
a.keyClose=b?b:!1}};
