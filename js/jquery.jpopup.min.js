function jPopup(a){function I(){"fixed"!=$("html").css("position")||$("[data-popup][data-overlay]").length||($("html").css("position","static"),$("html").scrollTop(-parseInt($("html").css("top"))),$("html").css({width:"",height:"",top:0}))}function p(){f.off("mousedown touchstart");h.off("scroll");d.off("click mousedown touchstart mmouseup touchend");w.children("div").off("mousedown touchstart");$(window).off("resize",z);$(document).off("mousemove touchmove",A);$(document).off("mouseup touchend",
B);d.fadeOut(a.speed,function(){d.remove();I()});k.fadeOut(a.speed,function(){k.remove()});C=!1}function J(){a.overlay?(d.attr("data-overlay",""),k.css("z-index",d.css("z-index")).fadeIn(a.speed),K=$("html").scrollTop(),"fixed"!=$("html").css("position")&&a.overlay&&$("html").css({width:"100%",height:"100%",position:"fixed",top:-K})):(d.removeAttr("data-overlay"),k.fadeOut(a.speed),I())}function L(){a.draggable?(f.css("cursor","move"),"bottom"!=a.position&&"bottomLeft"!=a.position&&"bottomRight"!=
a.position&&"stretchBottom"!=a.position||!a.stickToBottom||(stickToBottom=!1,q()),d.attr("data-draggable","")):(f.css("cursor","inherit"),d.removeAttr("data-draggable"))}function M(){a.resizeable?(w.show(),d.attr("data-resizeable","")):(w.hide(),d.removeAttr("data-resizeable"))}function N(){a.buttons.length?d.attr("data-buttons",""):d.removeAttr("data-buttons")}function O(){a.closeButton?r.show():r.hide()}function q(){switch(a.position){case "center":d.css({width:0,height:0,position:"fixed",top:"50%",
left:"50%",bottom:"",right:""});c.css({width:"",height:"",position:"relative",top:-c.outerHeight()/2,left:-c.outerWidth()/2,bottom:""});break;case "top":d.css({width:0,height:0,position:"fixed",top:0,left:"50%",bottom:"",right:""});c.css({width:"",height:"",position:"relative",top:0,left:-c.outerWidth()/2,bottom:""});break;case "left":d.css({width:0,height:0,position:"fixed",top:"50%",left:0,bottom:"",right:""});c.css({width:"",height:"",position:"relative",top:-c.outerHeight()/2,left:0,bottom:""});
break;case "bottom":d.css({width:0,height:0,position:"fixed",top:"",left:"50%",bottom:0,right:""});"bottom"!=a.position&&"bottomLeft"!=a.position&&"bottomRight"!=a.position&&"stretchBottom"!=a.position||a.draggable?c.css({width:"",height:"",position:"relative",top:-c.outerHeight(),left:-c.outerWidth()/2,bottom:""}):c.css({position:"absolute",top:"",left:-c.outerWidth()/2,bottom:0});break;case "right":d.css({width:0,height:0,position:"fixed",top:"50%",left:"",bottom:0,right:0});c.css({width:"",height:"",
position:"relative",top:-c.outerHeight()/2,left:-c.outerWidth(),bottom:""});break;case "topLeft":d.css({width:0,height:0,position:"fixed",top:0,left:0,bottom:"",right:""});c.css({width:"",height:"",position:"relative",top:0,left:0,bottom:""});break;case "topRight":d.css({width:0,height:0,position:"fixed",top:0,left:"",bottom:"",right:0});c.css({width:"",height:"",position:"relative",top:0,left:-c.outerWidth(),bottom:""});break;case "bottomLeft":d.css({width:0,height:0,position:"fixed",top:"",left:"0",
bottom:0,right:""});a.stickToBottom&&!a.draggable?c.css({position:"absolute",top:"",left:0,bottom:0}):c.css({width:"",height:"",position:"relative",top:-c.outerHeight(),left:0,bottom:""});break;case "bottomRight":d.css({width:0,height:0,position:"fixed",top:"",left:"",bottom:0,right:0});a.stickToBottom&&!a.draggable?c.css({position:"absolute",top:"",left:-c.outerWidth(),bottom:0}):c.css({width:"",height:"",position:"relative",top:-c.outerHeight(),left:-c.outerWidth(),bottom:""});break;case "stretchTop":d.css({width:"100%",
height:0,position:"fixed",top:0,left:0,bottom:"",right:""});c.css({width:"100%",height:"",position:"relative",top:0,left:0,bottom:""});break;case "stretchLeft":d.css({width:0,height:"100%",position:"fixed",top:0,left:0,bottom:"",right:""});c.css({width:"",height:"100%",position:"relative",top:0,left:0,bottom:""});break;case "stretchBottom":d.css({width:"100%",height:0,position:"fixed",top:"",left:0,bottom:0,right:""});a.stickToBottom&&!a.draggable?c.css({width:"100%",height:"",position:"absolute",
top:"",left:0,bottom:0}):c.css({width:"100%",height:"",position:"relative",top:"",left:0,bottom:""});break;case "stretchRight":d.css({width:0,height:"100%",position:"fixed",top:0,left:"",bottom:"",right:0});c.css({width:"",height:"100%",position:"relative",top:0,left:-c.outerWidth(),bottom:""});break;case "full":d.css({width:"100%",height:"100%",position:"fixed",top:0,left:0,bottom:"",right:""}),c.css({width:"100%",height:"100%",position:"relative",top:0,left:0,bottom:""})}}function D(){if(a.draggable||
!a.stickToBottom||"bottom"!=a.position&&"bottomLeft"!=a.position&&"bottomRight"!=a.position&&"stretchBottom"!=a.position)0>$(window).height()-c.offset().top-c.outerHeight()+$("html").scrollTop()&&c.offset({top:$(window).height()-c.outerHeight()+$("html").scrollTop()}),0>$(window).width()-c.offset().left-c.outerWidth()&&c.offset({left:$(window).width()-c.outerWidth()}),0>c.offset().top-$("html").scrollTop()&&(a.draggable||"bottom"!=a.position)&&c.offset({top:$("html").scrollTop()}),0>c.offset().left&&
c.offset({left:0})}function P(){d.removeClass(a.overflowXClass+" "+a.overflowYClass);var b=c.outerWidth()>$(window).width()?!0:!1,u=c.outerHeight()>$(window).height()?!0:!1;b&&d.addClass(a.overflowXClass);u&&d.addClass(a.overflowYClass)}function E(){h.scrollTop()?d.removeClass(a.scrollTopClass):d.addClass(a.scrollTopClass);c.outerHeight();$(window).height();h.prop("scrollHeight")-h.height()-h.scrollTop()?d.removeClass(a.scrollBottomClass):d.addClass(a.scrollBottomClass)}function T(){var a=F()+1;d.css("z-index",
a);k.css("z-index",a)}function U(){var a=d.css("z-index"),c=F();$("[data-popup]").each(function(){var c=parseInt($(this).css("z-index"));c>a&&$(this).css("z-index",c-1)});d.css("z-index",c)}function F(){var a=[9999];$("[data-popup]").each(function(){var c=parseInt($(this).css("z-index"));c&&a.push(c)});return Math.max.apply(Math,a)}function Q(b,d){"stretchTop"==a.position||"stretchLeft"==a.position||"stretchBottom"==a.position||"stretchRight"==a.position||"bottom"==a.position&&!a.draggable||(d=void 0==
d?a.offset.y:d,b=void 0==b?a.offset.x:b,l=c.offset().top,m=c.offset().left,c.offset({top:l-d,left:m+b}),D())}function R(){for(var b="",c=0;c<a.buttons.length;c++)b+="<button"+(a.buttons[c].buttonClass?" class="+a.buttons[c].buttonClass:"")+(!1===a.buttons[c].close?" data-close="+a.buttons[c].close:"")+(a.buttons[c].checkForm?" data-checkform=true":"")+(void 0!==a.buttons[c].value?" data-value="+a.buttons[c].value:"")+">"+(a.buttons[c].text||"")+"</button>";return b}a=$.extend({title:"",content:"",
buttons:[],popupClass:"popup",wrapperClass:"popup_wrapper",overlayClass:"popup_overlay",titleClass:"popup_title",contentClass:"popup_content",buttonsClass:"popup_buttons",overflowXClass:"popup_overflow_x",overflowYClass:"popup_overflow_y",scrollTopClass:"popup_scroll_top",scrollBottomClass:"popup_scroll_bottom",resizeClass:"popup_resize",closeButtonClass:"popup_close",closeButtonContent:'&times;<svg fill="#000000" width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>',
closeButton:!1,overlay:!0,overlayClose:!1,draggable:!1,resizeable:!1,position:"center",offset:{x:0,y:0},speed:200,stickToBottom:!0,keyClose:!1},a);var S=$('<div><div class="'+a.overlayClass+'" style="position:fixed;top:0;left:0;bottom:0;right:0;display:none;"></div><div class="'+a.wrapperClass+'" style="opacity:0;" data-popup><form class="'+a.popupClass+'" style="position:relative;float:left;"><div class="'+a.titleClass+'">'+a.title+'</div><div class="'+a.contentClass+'">'+a.content+'</div><div class="'+
a.buttonsClass+'">'+R()+'</div><div class="'+a.resizeClass+'" style="display: none;"><div style="position:absolute;top:0;left:0;right: 0;height:6px;cursor:n-resize;"></div><div style="position:absolute;top:0;left:0;bottom:0;width:6px;cursor:w-resize;"></div><div style="position:absolute;left:0;bottom:0;right:0;height:6px;cursor:s-resize;"></div><div style="position:absolute;top:0;bottom:0;right:0;width:6px;cursor:e-resize;"></div><div style="position:absolute;top:0;left:0;width:6px;height:6px;cursor:nw-resize;"></div><div style="position:absolute;top:0;right:0;width:6px;height:6px;cursor:ne-resize;"></div><div style="position:absolute;left:0;bottom:0;width:6px;height:6px;cursor:sw-resize;"></div><div style="position:absolute;bottom:0;right:0;width:6px;height:6px;cursor:se-resize;"></div></div><div class="'+
a.closeButtonClass+'">'+a.closeButtonContent+"</div></form></div></div>"),d=S.children("div:last-child"),k=S.children("div:first-child"),c=d.children("form"),f=c.children("."+a.titleClass),h=c.children("."+a.contentClass),y=c.children("."+a.buttonsClass),r=c.children("."+a.closeButtonClass),w=c.children("."+a.resizeClass),C,K,l,m,n,t,e,g,G,z,A,B,H,v;this.open=function(b){var u=$.Deferred();$("body").append(k).append(d);J();T();O();L();M();N();q();Q();P();E();d.attr("data-position",a.position).fadeTo(a.speed,
1);C=!0;var x=!1;y.on("click","button",function(a){a.preventDefault();a=$(this).data("value");var b=$(this).data("checkform"),d=$(this).data("close");"function"==typeof document.createElement("input").checkValidity&&b?(console.log(c[0].checkValidity()),c[0].checkValidity()?(x||u.notify(a,c),0!=d&&(p(),x=!0)):$('<input type="submit">').hide().appendTo(c).click().remove()):(x||u.notify(a,c),0!=d&&(p(),x=!0))});r.on("click",function(a){a.preventDefault();p()});h.on("scroll",function(){E()});z=function(){D();
P();E()};$(window).on("resize",z);f.on("mousedown touchstart",function(b){a.draggable&&(G=!0,l=c.offset().top,m=c.offset().left,e=b.pageY||b.originalEvent.touches[0].pageY,g=b.pageX||b.originalEvent.touches[0].pageX,$(document).bind("selectstart.disableSelection",function(a){a.preventDefault()}),$("[data-popup]").css("user-select","none"))});A=function(b){mY=void 0==b.pageY?b.originalEvent.touches[0].pageY:b.pageY;mX=void 0==b.pageX?b.originalEvent.touches[0].pageX:b.pageX;G&&a.draggable&&(c.offset({top:l+
mY-e,left:m+mX-g}),D());H&&a.resizeable&&(/0|4|5/.test(v)&&0<l+mY-e&&(c.css("height",""),n-mY+e>c.outerHeight()&&(c.outerHeight(n-mY+e),c.offset({top:l+mY-e}))),/1|4|6/.test(v)&&0<m+mX-g&&(c.css("width",""),t-mX+g>c.outerWidth()&&(c.outerWidth(t-mX+g),c.offset({left:m+mX-g}))),console.log($(window).height()),console.log(l+mY-e+n),/2|6|7/.test(v)&&l+mY-e+n<$(window).height()&&(c.css("height",""),n+mY-e>c.outerHeight()&&c.outerHeight(n+mY-e)),/3|5|7/.test(v)&&m+mX-g+t<$(window).width()&&(c.css("width",
""),t+mX-g>c.outerWidth()&&c.outerWidth(t+mX-g)))};$(document).on("mousemove touchmove",A);B=function(b){a.resizeable&&(H=!1,f.css("cursor",""),$("html").css("cursor",""));a.draggable&&(G=!1,f.css("cursor","move"));$(document).unbind(".disableSelection");$("[data-popup]").css("user-select","")};$(document).on("mouseup touchend",B);d.on("mousedown touchstart",function(){a.draggable&&U()});k.on("click",function(){a.overlayClose&&p()});$(document).on("keydown",function(b){b.which==a.keyClose&&d.css("z-index")==
F()&&C&&p()});w.children("div").on("mousedown touchstart",function(b){a.resizeable&&(H=!0,l=c.offset().top,m=c.offset().left,n=c.outerHeight(),t=c.outerWidth(),e=b.pageY||b.originalEvent.touches[0].pageY,g=b.pageX||b.originalEvent.touches[0].pageX,v=$(this).index(),f.css("cursor",$(this).css("cursor")),$("html").css("cursor",$(this).css("cursor")),$("[data-popup]").css("user-select","none"),$(document).bind("selectstart.disableSelection",function(a){a.preventDefault()}))});return u.progress(b)};this.close=
function(){p();return this};this.addClass=function(a){d.addClass(a);return this};this.removeClass=function(a){d.removeClass(a);return this};this.title=function(b){if(void 0==b)return a.title;f.html(a.fTitle);a.title=b;return this};this.content=function(b){if(void 0==b)return a.content;h.html(a.fContent);a.content=b;return this};this.buttons=function(b){if(void 0==b)return a.buttons;a.buttons=b;y.html(R());N();return this};this.overlay=function(b){if(void 0==b)return a.overlay;a.overlay=b?!0:!1;J();
return this};this.draggable=function(b){if(void 0==b)return a.draggable;a.draggable=b?!0:!1;L();return this};this.resizeable=function(b){if(void 0==b)return a.resizeable;a.resizeable=b?!0:!1;M();return this};this.closeButton=function(b){if(void 0==b)return a.closeButton;a.closebutton=b?!0:!1;O();return this};this.popupClass=function(b){if(void 0==b)return a.popupClass;c.removeClass(a.popupClass).addClass(b);a.popupClass=b;return this};this.wrapperClass=function(b){if(void 0==b)return a.wrapperClass;
d.removeClass(a.wrapperClass).addClass(b);a.wrapperClass=b;return this};this.overlayClass=function(b){if(void 0==b)return a.overlayClass;k.removeClass(a.overlayClass).addClass(b);a.overlayClass=b;return this};this.titleClass=function(b){if(void 0==b)return a.titleClass;f.removeClass(a.titleClass).addClass(b);a.titleClass=b;return this};this.contentClass=function(b){if(void 0==b)return a.contentClass;h.removeClass(a.contentClass).addClass(b);a.contentClass=b;return this};this.buttonsClass=function(b){if(void 0==
b)return a.buttonsClass;y.removeClass(a.buttonsClass).addClass(b);a.buttonsClass=b;return this};this.overflowXClass=function(b){if(void 0==b)return a.overflowXClass;d.removeClass(a.overflowXClass).addClass(b);a.overflowXClass=b;return this};this.overflowYClass=function(b){if(void 0==b)return a.overflowYClass;d.removeClass(a.overflowYClass).addClass(b);a.overflowYClass=b;return this};this.scrollTopClass=function(b){if(void 0==b)return a.scrollTopClass;d.removeClass(a.scrollTopClass).addClass(b);a.scrollTopClass=
b;return this};this.scrollBottomClass=function(b){if(void 0==b)return a.scrollBottomClass;d.removeClass(a.scrollBottomClass).addClass(b);a.scrollBottomClass=b;return this};this.closeButtonClass=function(b){if(void 0==b)return a.closeButtonClass;r.removeClass(a.closeButtonClass).addClass(b);a.closeButtonClass=b;return this};this.closeButtonContent=function(b){if(void 0==fCloseButtonHTML)return a.closeButtonContent;r.html(closeButtonContent);a.closeButtonContent=b;return this};this.speed=function(b){if(void 0==
fSpeed)return a.speed;a.speed=fSpeed;return this};this.position=function(b){if(void 0==b)return a.position;d.removeAttr("data-position").attr("data-position",b);a.position=b;a.offset.y=0;a.offset.x=0;q();q();return this};this.offset=function(b){if(void 0==b){b={};switch(a.position){case "center":case "left":case "right":b.y=d.offset().top-c.offset().top-c.outerHeight()/2;break;case "top":case "topLeft":case "topRight":case "stretchTop":case "stretchLeft":case "stretchRight":b.y=d.offset().top-c.offset().top;
break;case "bottom":case "bottomLeft":case "bottomRight":case "stretchBottom":b.y=d.offset().top-c.offset().top-c.outerHeight()}switch(a.position){case "center":case "top":case "bottom":b.x=c.offset().left-d.offset().left+c.outerWidth()/2;break;case "left":case "topLeft":case "bottomLeft":case "stretchTop":case "stretchLeft":case "stretchBottom":b.x=c.offset().left-d.offset().left;break;case "right":case "topRight":case "bottomRight":case "stretchRight":b.x=c.offset().left-d.offset().left+c.outerWidth()}b.y=
Math.round(b.y);b.x=Math.floor(b.x);return b}Q(void 0==b.x?0:b.x,void 0==b.y?0:b.y);return this};this.overlayClose=function(b){if(void 0==b)return a.overlayClose;a.overlayClose=b?!0:!1;return this};this.stickToBottom=function(b){if(void 0==b)return a.stickToBottom;a.stickToBottom=b?!0:!1;a.offset.y=0;a.offset.x=0;q();q()};this.keyClose=function(b){if(void 0==b)return a.keyClose;a.keyClose=b?b:!1};this.popupWrapper=function(){return d};this.popupOverlay=function(){return k};this.popup=function(){return c};
this.popupTitle=function(){return f};this.popupContent=function(){return h};this.popupButtons=function(){return y};this.popupClose=function(){return r}};
