function jPopup(a){function z(){"fixed"!=$("html").css("position")||$("[data-popup][data-overlay]").length||($("html").css("position","static"),$("html").scrollTop(-parseInt($("html").css("top"))),$("html").css({width:"",height:"",top:0}))}function h(){g.off("mousedown touchstart");e.off("scroll");d.off("click mousedown touchstart mmouseup touchend");$(window).off("resize",r);$(document).off("mousemove touchmove",t);d.fadeOut(a.speed,function(){d.remove();z()});f.fadeOut(a.speed,function(){f.remove()});
u=!1}function A(){a.overlay?(d.attr("data-overlay",""),f.css("z-index",d.css("z-index")).show(),B=$("html").scrollTop(),"fixed"!=$("html").css("position")&&a.overlay&&$("html").css({width:"100%",height:"100%",position:"fixed",top:-B})):(d.removeAttr("data-overlay"),f.hide(),z())}function C(){a.draggable?(g.css("cursor","move"),"bottom"!=a.position&&"bottomLeft"!=a.position&&"bottomRight"!=a.position&&"stretchBottom"!=a.position||!a.stickToBottom||(stickToBottom=!1,k())):g.css("cursor","inherit")}
function D(){a.closeButton?l.show():l.hide()}function k(){switch(a.position){case "center":d.css({width:0,height:0,position:"fixed",top:"50%",left:"50%",bottom:"",right:""});c.css({width:"",height:"",position:"relative",top:-c.outerHeight()/2,left:-c.outerWidth()/2,bottom:""});break;case "top":d.css({width:0,height:0,position:"fixed",top:0,left:"50%",bottom:"",right:""});c.css({width:"",height:"",position:"relative",top:0,left:-c.outerWidth()/2,bottom:""});break;case "left":d.css({width:0,height:0,
position:"fixed",top:"50%",left:0,bottom:"",right:""});c.css({width:"",height:"",position:"relative",top:-c.outerHeight()/2,left:0,bottom:""});break;case "bottom":d.css({width:0,height:0,position:"fixed",top:"",left:"50%",bottom:0,right:""});"bottom"!=a.position&&"bottomLeft"!=a.position&&"bottomRight"!=a.position&&"stretchBottom"!=a.position||a.draggable?c.css({width:"",height:"",position:"relative",top:-c.outerHeight(),left:-c.outerWidth()/2,bottom:""}):c.css({position:"absolute",top:"",left:-c.outerWidth()/
2,bottom:0});break;case "right":d.css({width:0,height:0,position:"fixed",top:"50%",left:"",bottom:0,right:0});c.css({width:"",height:"",position:"relative",top:-c.outerHeight()/2,left:-c.outerWidth(),bottom:""});break;case "topLeft":d.css({width:0,height:0,position:"fixed",top:0,left:0,bottom:"",right:""});c.css({width:"",height:"",position:"relative",top:0,left:0,bottom:""});break;case "topRight":d.css({width:0,height:0,position:"fixed",top:0,left:"",bottom:"",right:0});c.css({width:"",height:"",
position:"relative",top:0,left:-c.outerWidth(),bottom:""});break;case "bottomLeft":d.css({width:0,height:0,position:"fixed",top:"",left:"0",bottom:0,right:""});"bottom"!=a.position&&"bottomLeft"!=a.position&&"bottomRight"!=a.position&&"stretchBottom"!=a.position||a.draggable?c.css({width:"",height:"",position:"relative",top:-c.outerHeight(),left:0,bottom:""}):c.css({position:"absolute",top:"",left:0,bottom:0});break;case "bottomRight":d.css({width:0,height:0,position:"fixed",top:"",left:"",bottom:0,
right:0});"bottom"!=a.position&&"bottomLeft"!=a.position&&"bottomRight"!=a.position&&"stretchBottom"!=a.position||a.draggable?c.css({width:"",height:"",position:"relative",top:-c.outerHeight(),left:-c.outerWidth(),bottom:""}):c.css({position:"absolute",top:"",left:-c.outerWidth(),bottom:0});break;case "stretchTop":d.css({width:"100%",height:0,position:"fixed",top:0,left:0,bottom:"",right:""});c.css({width:"100%",height:"",position:"relative",top:0,left:0,bottom:""});break;case "stretchLeft":d.css({width:0,
height:"100%",position:"fixed",top:0,left:0,bottom:"",right:""});c.css({width:"",height:"100%",position:"relative",top:0,left:0,bottom:""});break;case "stretchBottom":d.css({width:"100%",height:0,position:"fixed",top:"",left:0,bottom:0,right:""});"bottom"!=a.position&&"bottomLeft"!=a.position&&"bottomRight"!=a.position&&"stretchBottom"!=a.position||a.draggable?c.css({width:"100%",height:"",position:"relative",top:-c.outerHeight(),left:0,bottom:""}):c.css({width:"100%",height:"",position:"absolute",
top:"",left:0,bottom:0});break;case "stretchRight":d.css({width:0,height:"100%",position:"fixed",top:0,left:"",bottom:"",right:0}),c.css({width:"",height:"100%",position:"relative",top:0,left:-c.outerWidth(),bottom:""})}}function v(){0>$(window).height()-c.offset().top-c.outerHeight()+$("html").scrollTop()&&c.offset({top:$(window).height()-c.outerHeight()+$("html").scrollTop()});0>$(window).width()-c.offset().left-c.outerWidth()&&c.offset({left:$(window).width()-c.outerWidth()});0>c.offset().top-
$("html").scrollTop()&&(a.draggable||"bottom"!=a.position)&&c.offset({top:$("html").scrollTop()});0>c.offset().left&&c.offset({left:0})}function E(){d.removeClass(a.overflowXClass+" "+a.overflowYClass);var b=c.outerWidth()>$(window).width()?!0:!1,m=c.outerHeight()>$(window).height()?!0:!1;b&&d.addClass(a.overflowXClass);m&&d.addClass(a.overflowYClass)}function w(){e.scrollTop()?d.removeClass(a.scrollTopClass):d.addClass(a.scrollTopClass);e.prop("scrollHeight")-e.height()-e.scrollTop()?d.removeClass(a.scrollBottomClass):
d.addClass(a.scrollBottomClass)}function K(){var a=d.css("z-index"),c=x();$("[data-popup]").each(function(){var c=parseInt($(this).css("z-index"));c>a&&$(this).css("z-index",c-1)});d.css("z-index",c)}function x(){var a=[9999];$("[data-popup]").each(function(){var c=parseInt($(this).css("z-index"));c&&a.push(c)});return Math.max.apply(Math,a)}function F(b,d){d=void 0==d?a.offset.y:d;b=void 0==b?a.offset.x:b;fY=c.offset().top;p=c.offset().left;c.offset({top:fY-d,left:p+b});v()}function G(){for(var b=
"",c=0;c<a.buttons.length;c++)b+="<button"+(a.buttons[c]["class"]?" class="+a.buttons[c]["class"]:"")+(!1===a.buttons[c].close?" data-close="+a.buttons[c].close:"")+(a.buttons[c].checkForm?" data-checkform=true":"")+(void 0!==a.buttons[c].value?" data-value="+a.buttons[c].value:"")+">"+(a.buttons[c].text||"")+"</button>";return b}a=$.extend({title:"",content:"",buttons:[],popupClass:"popup",wrapperClass:"popup_wrapper",overlayClass:"popup_overlay",titleClass:"popup_title",contentClass:"popup_content",
buttonsClass:"popup_buttons",overflowXClass:"popup_overflow_x",overflowYClass:"popup_overflow_y",scrollTopClass:"popup_scroll_top",scrollBottomClass:"popup_scroll_bottom",closeButtonClass:"popup_close",closeButtonContent:'&times;<svg fill="#000000" width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>',closeButton:!1,overlay:!0,overlayClose:!1,draggable:!1,
position:"center",offset:{x:0,y:0},speed:200,stickToBottom:!0,keyClose:!1},a);var H=$('<div><div class="'+a.overlayClass+'" style="position: fixed; top: 0; left: 0; bottom: 0; right: 0;"></div><div class="'+a.wrapperClass+'" style="opacity: 0;" data-popup><form class="'+a.popupClass+'" style="position: relative; float: left;"><div class="'+a.titleClass+'">'+a.title+'</div><div class="'+a.contentClass+'">'+a.content+'</div><div class="'+a.buttonsClass+'">'+G()+'</div><div class="'+a.closeButtonClass+
'">'+a.closeButtonContent+"</div></form></div></div>"),d=H.children("div:last-child"),c=d.children("form"),f=H.children("div:first-child"),g=c.children("."+a.titleClass),e=c.children("."+a.contentClass),q=c.children("."+a.buttonsClass),l=c.children("."+a.closeButtonClass),u,B,p,I,J,y=!1,r,t;this.open=function(b){var m=$.Deferred();$("body").append(f).append(d);d.css("z-index",x()+1);A();D();C();k();F();E();w();d.attr("data-position",a.position).fadeTo(a.speed,1);u=!0;var n=!1;q.on("click","button",
function(a){a.preventDefault();a=$(this).data("value");var b=$(this).data("checkform"),d=$(this).data("close");"function"==typeof document.createElement("input").checkValidity&&b?(console.log(c[0].checkValidity()),c[0].checkValidity()?(n||m.notify(a,c),0!=d&&(h(),n=!0)):$('<input type="submit">').hide().appendTo(c).click().remove()):(n||m.notify(a,c),0!=d&&(h(),n=!0))});l.on("click",function(a){a.preventDefault();h()});e.on("scroll",function(){w()});r=function(){v();E();w()};$(window).on("resize",
r);g.on("mousedown touchstart",function(b){a.draggable&&(y=!0,fY=c.offset().top,p=c.offset().left,I=b.pageY||b.originalEvent.touches[0].pageY,J=b.pageX||b.originalEvent.touches[0].pageX,c.css("user-select","none"))});t=function(b){y&&a.draggable&&(mY=void 0==b.pageY?b.originalEvent.touches[0].pageY:b.pageY,mX=void 0==b.pageX?b.originalEvent.touches[0].pageX:b.pageX,c.offset({top:fY+mY-I,left:p+mX-J}),v())};$(document).on("mousemove touchmove",t);d.on("mouseup touchend",function(b){a.draggable&&(y=
!1,c.css("user-select","inherit"))});d.on("mousedown touchstart",function(){a.draggable&&K()});f.on("click",function(){a.overlayClose&&h()});$(document).on("keydown",function(b){b.which==a.keyClose&&d.css("z-index")==x()&&u&&h()});return m.progress(b)};this.close=function(){h();return this};this.addClass=function(a){d.addClass(a);return this};this.removeClass=function(a){d.removeClass(a);return this};this.title=function(b){if(void 0==b)return a.title;g.html(a.fTitle);a.title=b;return this};this.content=
function(b){if(void 0==b)return a.content;e.html(a.fContent);a.content=b;return this};this.buttons=function(b){if(void 0==b)return a.buttons;a.buttons=b;q.html(G());return this};this.overlay=function(b){if(void 0==b)return a.overlay;a.overlay=b?!0:!1;A();return this};this.draggable=function(b){if(void 0==b)return a.draggable;a.draggable=b?!0:!1;C();return this};this.closeButton=function(b){if(void 0==b)return a.closeButton;a.closebutton=b?!0:!1;D();return this};this.popupClass=function(b){if(void 0==
b)return a.popupClass;c.removeClass(a.popupClass).addClass(b);a.popupClass=b;return this};this.wrapperClass=function(b){if(void 0==b)return a.wrapperClass;d.removeClass(a.wrapperClass).addClass(b);a.wrapperClass=b;return this};this.overlayClass=function(b){if(void 0==b)return a.overlayClass;f.removeClass(a.overlayClass).addClass(b);a.overlayClass=b;return this};this.titleClass=function(b){if(void 0==b)return a.titleClass;g.removeClass(a.titleClass).addClass(b);a.titleClass=b;return this};this.contentClass=
function(b){if(void 0==b)return a.contentClass;e.removeClass(a.contentClass).addClass(b);a.contentClass=b;return this};this.buttonsClass=function(b){if(void 0==b)return a.buttonsClass;q.removeClass(a.buttonsClass).addClass(b);a.buttonsClass=b;return this};this.overflowXClass=function(b){if(void 0==b)return a.overflowXClass;d.removeClass(a.overflowXClass).addClass(b);a.overflowXClass=b;return this};this.overflowYClass=function(b){if(void 0==b)return a.overflowYClass;d.removeClass(a.overflowYClass).addClass(b);
a.overflowYClass=b;return this};this.scrollTopClass=function(b){if(void 0==b)return a.scrollTopClass;d.removeClass(a.scrollTopClass).addClass(b);a.scrollTopClass=b;return this};this.scrollBottomClass=function(b){if(void 0==b)return a.scrollBottomClass;d.removeClass(a.scrollBottomClass).addClass(b);a.scrollBottomClass=b;return this};this.closeButtonClass=function(b){if(void 0==b)return a.closeButtonClass;l.removeClass(a.closeButtonClass).addClass(b);a.closeButtonClass=b;return this};this.closeButtonContent=
function(b){if(void 0==fCloseButtonHTML)return a.closeButtonContent;l.html(fCloseButtonHTML);a.closeButtonContent=b;return this};this.speed=function(b){if(void 0==fSpeed)return a.speed;a.speed=fSpeed;return this};this.position=function(b){if(void 0==b)return a.position;d.removeAttr("data-position").attr("data-position",b);a.position=b;a.offset.y=0;a.offset.x=0;k();k();return this};this.offset=function(b){if(void 0==b){b={};switch(a.position){case "center":case "left":case "right":b.y=d.offset().top-
c.offset().top-c.outerHeight()/2;break;case "top":case "topLeft":case "topRight":case "stretchTop":case "stretchLeft":case "stretchRight":b.y=d.offset().top-c.offset().top;break;case "bottom":case "bottomLeft":case "bottomRight":case "stretchBottom":b.y=d.offset().top-c.offset().top-c.outerHeight()}switch(a.position){case "center":case "top":case "bottom":b.x=c.offset().left-d.offset().left+c.outerWidth()/2;break;case "left":case "topLeft":case "bottomLeft":case "stretchTop":case "stretchLeft":case "stretchBottom":b.x=
c.offset().left-d.offset().left;break;case "right":case "topRight":case "bottomRight":case "stretchRight":b.x=c.offset().left-d.offset().left+c.outerWidth()}b.y=Math.round(b.y);b.x=Math.floor(b.x);return b}F(void 0==b.x?0:b.x,void 0==b.y?0:b.y);return this};this.overlayClose=function(b){if(void 0==b)return a.overlayClose;a.overlayClose=b?!0:!1;return this};this.stickToBottom=function(b){if(void 0==b)return a.stickToBottom;a.stickToBottom=b?!0:!1;a.offset.y=0;a.offset.x=0;k();k()};this.keyClose=function(b){if(void 0==
b)return a.keyClose;a.keyClose=b?b:!1};this.popupWrapper=function(){return d};this.popupOverlay=function(){return f};this.popup=function(){return c};this.popupTitle=function(){return g};this.popupContent=function(){return e};this.popupButtons=function(){return q};this.popupClose=function(){return l}};
